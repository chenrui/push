/*! appstore */
$(function(){function a(a){a.eBtn.click(function(){var b=$.checkboxVal(a.eCheckBoxClass);b.length>0?bootbox.confirm("确实要删除所选"+a.txt+"吗？",function(c){c&&$.sendAjax({url:a.url,type:"POST",data:b})}):bootbox.alert("请先选择要删除的"+a.txt,function(){})})}function b(a){a.eBtn.click(function(){function b(b){$.sendAjax({url:a.url,type:"POST",data:{ids:c,result:b}})}var c=$.checkboxVal(a.eCheckBoxClass);c.length>0?bootbox.dialog({message:"您选中的"+a.txt+"是否通过？",title:a.txt+"确认",buttons:{approve:{label:a.txt+"通过",className:"btn-success",callback:function(){b(1)}},reject:{label:a.txt+"不通过",className:"btn-warning",callback:function(){b(2)}}}}):bootbox.alert("请先选择要处理的"+a.txt,function(){})})}bootbox.setDefaults({locale:"zh_CN"}),$.selectAllToggle("user-comt-check","user-comt-check-item");var c={eBtn:$("#btn-usrc-del"),eCheckBoxClass:"user-comt-check-item",txt:"评论",url:"/admin/comment/delete/"};a(c);var d={eBtn:$("#btn-usrc-verify"),eCheckBoxClass:"user-comt-check-item",txt:"评论",url:"/admin/comment/verify/"};b(d),$.selectAllToggle("user-comp-check","user-comp-check-item");var c={eBtn:$("#btn-usrcp-del"),eCheckBoxClass:"user-comp-check-item",txt:"评论",url:"/admin/report/delete/"};a(c);var e={eBtn:$("#btn-usrcp-deal"),eCheckBoxClass:"user-comp-check-item",txt:"举报",url:"/admin/report/verify/"};b(e),$(".verify-status").changeStatus("verify_status"),$(".btn-sf-detail").click(function(){var a=$(this).attr("name"),b={url:"/admin/app/show_detail/"+a+"/",type:"GET",callback:function(a){var b=a.data;$("#sf-name").html(b.name),$("#sf-cate").html(b.category),$("#sf-provider").html(b.provider),$("#res-type").html(b.pay_type),$("#sf-desc").html(b.description),$("#sf-version").html(b.version_name),$("#sf-update-date").html(b.update_time),$("#sf-screenshot").html("");for(var c=b.screenshot,d=c.split(","),e=0,f=d.length;f>e;e++){var g=document.createElement("img");g.src=d[e],g.alt=b.name+"-截图"+(e+1),g.width=100,document.getElementById("sf-screenshot").appendChild(g)}$("#sf-detail-modal").modal("show"),$(".modal-footer").hide()}};$.sendAjax(b)});var f={language:"zh-CN",format:"yyyy-mm-dd",weekStart:1,todayBtn:1,autoclose:1,todayHighlight:1,startView:2,minView:2,forceParse:0};$("#from-time").datetimepicker(f),$("#to-time").datetimepicker(f),$("#from-time").change(function(){$("#to-time").datetimepicker("setStartDate",$("#from-time").val())}),$("#to-time").change(function(){$("#from-time").datetimepicker("setEndDate",$("#to-time").val())}),$(".form_datetime").focus(function(){this.blur()});var g=$("#upgradeType"),h=$("#confirmType");$("#add").on("click",function(){return $("option:selected",g).appendTo(h),!1}),$("#remove").on("click",function(){return $("option:selected",h).appendTo(g),!1}),g.on("dblclick",function(){$("option:selected",this).appendTo(h)}),h.on("dblclick",function(){$("option:selected",this).appendTo(g)}),$(".form-upgrade").on("submit",function(){var a=$(this),b=$("#upgradeExplain"),c=$.trim(b.val());if(""==c)return bootbox.alert("升级说明不能为空!"),!1;if(c.length>200)return bootbox.alert("升级说明不能超过200个字符!"),!1;var d=[];if($("option",h).each(function(){var a=$(this).val();d.push(a)}),!d.length)return bootbox.alert("升级机型不能为空!"),!1;var e={upgrade_pms:d,upgrade_explain:c},f={url:a.attr("action"),type:"post",dataType:"json",contentType:"application/json",data:JSON.stringify(e),success:function(a){"success"==a.status?$.reload():bootbox.alert(a.msg)},error:function(){bootbox.alert("服务器错误")}};return bootbox.dialog({message:"确认发布吗？",title:"机型升级确认",buttons:{approve:{label:"确认",className:"btn-success",callback:function(){$.ajax(f)}},reject:{label:"取消",className:"btn-warning"}}}),!1})});