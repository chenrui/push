/*! appstore */
!function(a){a.ajaxSetup({cache:!1}),a.extend({isNumber:function(a){var b=/^\d+$/;return b.test(a)},isEmail:function(a){var b=/^\w+([-\.]\w+)*@\w+([\.-]\w+)*\.\w{2,4}$/;return b.test(a)},isTel:function(){return!1},random:function(a,b){return 0==arguments.length?Math.random():1==arguments.length?Math.random()*arguments[0]:2==arguments.length?Math.random()*(b-a)+a:void console.log("function $.random(), params error!")},parseInt:function(a){return parseInt(a)},ceil:function(a){return Math.ceil(a)},floor:function(a){return Math.floor(a)},fillZero:function(a,b){for(var c=a.toString(),d=c.length,e=b-d,f=0;e>f;f++)c="0"+c;return c},date:function(){return new Date},xmonthDays:function(a,b){var c=new Date;return 0==arguments.length?c.getDate():12==b?(c.setFullYear(a+1),c.setMonth(0),c.setDate(0),c.getDate()):(c.setFullYear(a),c.setMonth(b),c.setDate(0),c.getDate())},spiltNumber:function(a,b,c){var d=a.toString(),e=d.length,f="";return f="H"==c?d.substr(0,b):d.substr(e-b,e-1)},randColor:function(){for(var a=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F"],b="#",c=0;6>c;c++){var d=this.parseInt(this.random(0,15));b+=a[d]}return b},selectAllToggle:function(b,c){a("#"+b).click(function(){var b=a(this).is(":checked");a("."+c).prop("checked",b)})},windowSize:function(){return{width:a(window).width(),height:a(window).height()}},reload:function(a){var b=location.href;location.href=0==arguments.length?b:a},anchor:function(){var a=location.hash,b=/^[#|\?]\w*/,c=a.match(b);return null==c||""==c?"#":c[0]},setPos:function(b,c){var d=location.hash,e=/^#[\w|-]*\d/,f=e.exec(d);if(null!=f&&""!=f){var g=/[0-9]*$/,h=g.exec(f),i="#"+c+"-"+h;a("."+c).removeClass("show"),a("."+c).addClass("hidden"),a(i).removeClass("hidden"),a(i).addClass("show");var j="#"+b+"-"+h;a("."+b).removeClass("active"),a(j).addClass("active")}},tabToggle:function(b,c){a("."+b).each(function(){a(this).click(function(){var d=a(this).attr("id"),e=/\d*$/,f=e.exec(d),g="#"+c+"-"+f;a("."+c).removeClass("show").addClass("hidden"),a(g).addClass("show").removeClass("hidden"),a("."+b).removeClass("active"),a(this).addClass("active")})})},checkboxVal:function(b){var c=[];return a("."+b).each(function(){var b=a(this).is(":checked");b&&c.push(+a(this).val())}),c},sendAjax:function(b,c){c=c?c:"POST";var d={url:"/",type:c,data:{},callback:""},e=a.extend(d,b||{});a.ajax({url:e.url,type:e.type,data:JSON.stringify(e.data),contentType:"application/json",async:e.sync,success:function(b){"function"==typeof e.callback?e.callback(b):"success"==b.status?""!=a.trim(b.msg)?bootbox.alert(b.msg,function(){a.reload()}):a.reload():bootbox.alert(b.msg)},error:function(a){"function"==typeof e.error?e.error(a):bootbox.alert("error!")}})},urlParam:function(a){var b=location.href,c=b.substring(b.indexOf("?")+1,b.length).split("&"),d={};for(i=0;j=c[i];i++)d[j.substring(0,j.indexOf("=")).toLowerCase()]=j.substring(j.indexOf("=")+1,j.length);var e=d[a.toLowerCase()];return"undefined"==typeof e?"":e},isDecimal:function(a){var b=/^[\d]+[\.][\d]+$/;return b.test(a)?!0:!1},isInteger:function(a){var b=/^[0-9]\d*$/;return b.test(a)?!0:!1},isNull:function(a){var b=!1;if(""==a)b=!0;else{var c=/^[ ]+$/;b=c.test(a)}return b},strLength:function(a,b){var b=b+1?b:15;return a.length>=b?!1:!0},checkFileSuffix:function(a,b){var c=new Array(".png"),d=new Array(".jpg",".jpeg",".png"),e=new Array(".apk");a=a.toLowerCase(),"png"==b?b=c:"img"==b?b=d:"apk"==b&&(b=e);var f=a.lastIndexOf("."),g=a.substr(f);for(i=0;i<b.length;i++)if(g==b[i])return!0;return!1},getdate:function(a){var b=new Date,c=b.setDate(b.getDate()-a),c=new Date(c),d=c.getFullYear(),e=c.getMonth()+1,f=c.getDate();return d+"-"+e+"-"+f},subStrLong:function(a,b,c){if(a.length<b+c+3)return a;var d=a.substr(0,b),e=a.substr(-c,c);return d+"..."+e}})}(jQuery),function(a){a.fn.extend({displayCenter:function(){var b=a(this),c=b.parent(),d=b.width(),e=b.height(),f=c.width(),g=c.height(),h=parseInt((f-d)/2),i=parseInt((g-e)/2);b.css("position","absolute").css("left",h).css("top",i)},elementSize:function(){var b=a(this),c=b.width(),d=b.height();return{width:c,height:d}},activeEle:function(b){a(this).removeClass("active"),a("#"+b).addClass("active")},checkboxTree:function(b){var c=function(b,d){for(var e=0;e<b.length;e++){var f=a("<li class='list-group-item' data-id='"+b[e].id+"' data-txt='"+b[e].text+"'>"+b[e].text+"<a class='glyphicon glyphicon-chevron-right pull-right add-block' title='添加版块'></a><a class='glyphicon glyphicon-chevron-left pull-right remove-block' title='移除版块'></a></li>");if(d.append(f),"object"==typeof b[e].children&&b[e].children.length>0){var g=a("<ul class='has-children'></ul>"),h=a("<span class='j-switch' style='cursor:pointer'><i class='glyphicon glyphicon-plus'></i> </span>");f.prepend(h),f.append(g),c(b[e].children,g)}else f.prepend("&nbsp;")}};c(b,a(this)),a(this).find("input[type='checkbox']").click(function(){var b=a(this).is(":checked");a(this).parent().find("ul li input[type='checkbox']").prop("checked",b)}),a(".j-switch").parent().find("ul").slideUp(0),a(".j-switch").click(function(){var b=a(this).parent().find(">ul"),c=b.css("display");"block"==c?(b.slideUp(0),a(this).html("<i class='glyphicon glyphicon-plus'></i> ")):(b.slideDown(0),a(this).html("<i class='glyphicon glyphicon-minus'></i> "))})},throwTree:function(b){var c=[],d=[],e=function(b,f){for(var g=0;g<b.length;g++)if("phonemodel"==b[g].node_type){c.length||(c=b[g].children);var h={};h.name=b[g].name,h.value=b[g].value,h.node_type="phonemodel",d.push(h)}else{var i=a("<li class='list-group-item' data-id='"+b[g].value+"' data-txt='"+b[g].name+"' data-type='"+b[g].node_type+"'>"+b[g].name+"<a class='glyphicon glyphicon-chevron-right pull-right add-block' title='添加版块'></a><a class='glyphicon glyphicon-chevron-left pull-right remove-block' title='移除版块'></a></li>");if(f.append(i),"object"==typeof b[g].children&&b[g].children.length>0){var j=a("<ul class='has-children'></ul>"),k=a("<span class='j-switch' style='cursor:pointer'><i class='glyphicon glyphicon-plus'></i> </span>");i.prepend(k),i.append(j),e(b[g].children,j)}else i.prepend("&nbsp;")}};e(b,a(this));var f=function(b,c){for(var d=0;d<b.length;d++){var f=a("<li class='list-group-item' data-id='"+b[d].value+"' data-txt='"+b[d].name+"' data-type='"+b[d].node_type+"'>"+b[d].name+"<a class='glyphicon glyphicon-chevron-right pull-right add-block' title='添加版块'></a><a class='glyphicon glyphicon-chevron-left pull-right remove-block' title='移除版块'></a></li>");if(c.append(f),"object"==typeof b[d].children&&b[d].children.length>0){var g=a("<ul class='has-children'></ul>"),h=a("<span class='j-switch' style='cursor:pointer'><i class='glyphicon glyphicon-plus'></i> </span>");f.prepend(h),f.append(g),e(b[d].children,g)}else f.prepend("&nbsp;")}},g=a('<li class="list-group-item" data-txt="首页" data-type="featrued"><span class="j-switch" style="cursor:pointer"><i class="glyphicon glyphicon-plus"></i> </span>首页&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;客户端选择 : <select class="phone-list input-sm"></select><a class="glyphicon glyphicon-chevron-right pull-right add-block" title="添加版块"></a><a class="glyphicon glyphicon-chevron-left pull-right remove-block" title="移除版块"></a><ul class="has-children" style="display: block;"></ul></li>');g.insertAfter("li[data-type=ads]");var h="";a(d).each(function(a){h+='<option value="'+d[a].value+'">'+d[a].name+"</option>"}),a(".phone-list").html(h),f(c,g.find(">ul.has-children")),a(".j-switch").parent().find("ul").slideUp(0),a(".j-switch").click(function(){var b=a(this).parent().find(">ul"),c=b.css("display");"block"==c?(b.slideUp(0),a(this).html("<i class='glyphicon glyphicon-plus'></i> ")):(b.slideDown(0),a(this).html("<i class='glyphicon glyphicon-minus'></i> "))})},treeDepth:function(){var a=[],b=function(c){var d=c.parent();d.is("ul")&&d.hasClass("has-children")&&(a.push(d.parent().attr("data-txt")),b(d.parent()))};return b(this),a},moduleTree:function(b){var c=function(b,d){for(var e=0;e<b.length;e++){var f=a("<li class='list-group-item'><span>"+b[e].text+"</span></li>");if(d.append(f),"object"==typeof b[e].children&&b[e].children.length>0){var g=a("<ul class='has-children'></ul>"),h=a("<span class='j-switch' style='cursor:pointer'><i class='glyphicon glyphicon-plus'></i> </span>");f.prepend(h),f.append(g),c(b[e].children,g)}else f.prepend("&nbsp;")}};c(b,a(this)),a(".j-switch").parent().find("ul").slideUp(0),a(".j-switch").click(function(){var b=a(this).parent().find(">ul"),c=b.css("display");"block"==c?(b.slideUp(0),a(this).html("<i class='glyphicon glyphicon-plus'></i> ")):(b.slideDown(0),a(this).html("<i class='glyphicon glyphicon-minus'></i> "))})},updatePriority:function(b,c){var d,e=a(this);e.focus(function(){d=a.trim(a(this).val())}).blur(function(){var e=a(this),f=e.parent().parent().find("input[type='checkbox']").val()||e.parent().parent().find("input[type='hidden']").val(),g=a.trim(e.val());if(!a.isNumber(g))return bootbox.alert("排序必须是数字!"),void e.val(d);if(Number(g)>9999)return bootbox.alert("排序超过范围(0~9999)"),void e.val(d);var h={};if(h.id=f,h[b]=g,g!=d){var i={url:c,sync:!1,data:h};a.sendAjax(i)}}),e.on("keydown",function(b){var b=b||window.event||arguments.callee.caller.arguments[0];b&&13==b.keyCode&&(b.preventDefault(),a(this).trigger("blur"))})},updateTag:function(b,c){for(var d=a(this),e=[],f=0,g=d.length;g>f;f++){var h=a(d[f]).attr("name");h!=a(d[f-1]).attr("name")&&(e[h]=a("input[name="+h+"]:checked").val())}d.on("click",function(){var d=a(this),f=d.attr("name"),g=a.trim(d.val());if(g!=e[f]){var h=d.parent().parent().parent().parent().find(".mp-check-item").val(),i={};i[b]=g,i.id=h;var j={url:c,sync:!1,data:i,callback:function(b){"failed"==b.status?bootbox.alert("修改失败"):a.reload()}};a.sendAjax(j)}})},update:function(b,c){var d=a(this);b=b?b:".",c=c?c:a.trim(d.attr("name")),"priority"==c?d.updatePriority(c,b):"tag_id"==c?d.updateTag(c,b):"per_page"==c&&d.updateItemsPerPage(c,b)},installUrl:function(a,b){function c(a,b){for(var c="",e=location.href.substring(0,location.href.indexOf("?")+1),f=location.search.substring(1),g=f.split("&"),h=0;h<g.length;h++){var i=g[h].indexOf("=");if(-1!=i){var j=g[h].substring(0,i),k=g[h].substring(i+1);c+=d(j,a)?j+"="+b+"&":j+"="+k+"&"}}return e+c.substring(0,c.length-1)}function d(a,b){return-1!=a.toLowerCase().indexOf(b.toLowerCase())?!0:!1}function e(){for(var a=new Object,b=location.search.substring(1),c=b.split("&"),d=0;d<c.length;d++){var e=c[d].indexOf("=");if(-1!=e){var f=c[d].substring(0,e),g=c[d].substring(e+1);a[f]=unescape(g)}}return a}var f=document.URL,g=e(),h=g[a];if(void 0==h){var i=location.search.substring(1);f+=i?"&"+a+"="+b:"?"+a+"="+b,window.location=f}else window.location=c(a,b)},updateItemsPerPage:function(b){var c;a(this).focus(function(){c=a.trim(a(this).val())}).change(function(){var d=a(this),e=a.trim(d.val());return a.isNumber(e)?Number(e)>9999?(bootbox.alert("条目数超过范围(0~9999)"),void d.val(c)):void(e!=c&&(d.installUrl(b,e),a.reload(url))):(bootbox.alert("条目数必须是数字!"),void d.val(c))})},changeStatus:function(b){var c=location.href,d=a.urlParam(b),e=(a.urlParam("sortModel"),a.urlParam("sortName"),c.substring(0,c.indexOf("?")));a(this).find("option").attr("selected",!1),a(this).find("option[value='"+d+"']").attr("selected",!0),a(this).change(function(){var f=a(this).val();if(-1!=f)if(-1==c.indexOf("?"))location.href=e+"?"+b+"="+f;else if("app_publish_status"!==b&&"verify_status"!==b||0!=f.length)if(""==d)location.href=c+"&"+b+"="+f;else{var g=c.split("?"),h=g[1];location.href=h.indexOf("&")==h.lastIndexOf("&")?c.substring(0,c.lastIndexOf("?"))+"?"+b+"="+f:c.substring(0,c.lastIndexOf("&"))+"&"+b+"="+f}else location.href=c.substring(0,c.indexOf("?"))})},imgPreview:function(){var b,c=a(this),d=10;c.mouseover(function(c){b=a("<img src='#' style='z-index:2000;'/>");var e=a(this).attr("src");b.attr("src",e),a("body").append(b);var f=b.height();if(120>=f)var g=c.clientX+d,h=c.clientY+d;else{var g=c.pageX+d;b.css("width","300"),f=b.height();var h=(a(window).height()-f)/2}b.css({position:"fixed",top:h,left:g})}),c.mouseout(function(){b.remove()})}})}(jQuery);